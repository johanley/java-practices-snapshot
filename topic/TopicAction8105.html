<!doctype html><html lang="en">
<!-- Mirrored from www.javapractices.com/topic/TopicAction.do?Id=56 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Jan 2021 15:52:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
 <meta charset="UTF-8">
 <!-- Global site tag (gtag.js) - Google Analytics -->
 <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2633428-1"></script>
 <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-2633428-1');
 </script>
 <meta name="description" content="Concise presentations of java programming practices, tasks, and conventions, amply illustrated with syntax highlighted code examples.">
 <meta name="keywords" content="unique,java,java programming,java practices,java idiom,java style,java design patterns,java coding conventions">
 <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
 <title>Java Practices-&gt;Generating unique IDs</title>
 <link id="stylesheet" rel="stylesheet" type="text/css" href="../stylesheet9fdb0.css?3.011" media="all">
 <link rel="icon" type="image/png" href="../images/favicon.png"> 
</head>
<body>
<nav class="menu-bar" id="menu-bar">
  <a href="../home/HomeAction.html" title="Table of Contents" style="float:left;">Home</a> &nbsp;&nbsp; 
  <form method="GET" action="https://www.google.com/search" class="search-form" style="float:right;">
   <input type="text" name="q" size="15" maxlength="255" value="" placeholder="Google">
   <input type="submit" name="btnG" value="Search">
   <input type="hidden" name="sitesearch" value="www.javapractices.com">
  </form>
</nav>
<div class="page-title">Generating unique IDs</div>

<br>When identifiers are used solely within a database, their generation
should be left to the database itself. (See <code><a href="https://docs.oracle.com/javase/10/docs/api/java/sql/Statement.html#getGeneratedKeys()">Statement.getGeneratedKeys</a></code>.)

<p>Unique identifiers which are "published" in some way may need special
treatment, since the identifier may need to be difficult to guess or forge.
A typical example is the value of a cookie used as a session identifier
- simply using a series of consecutive integers is generally unacceptable,
since one user could easily impersonate another by altering the value of
the cookie to some nearby integer.

</p><h3>Style 1 - UUID</h3>
Starting with Java 5, the 
<code><a href="https://docs.oracle.com/javase/10/docs/api/java/util/UUID.html">UUID</a></code> 
class provides a simple means for generating
unique ids. The identifiers generated by UUID are actually <em>universally</em>
unique identifiers.

<p><b>Example</b>
<br></p><pre>
<span class="keyword">import</span> java.util.UUID;

<span class="keyword">public</span> <span class="keyword">class</span> GenerateUUID {
  
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> main(String... args){
    <span class="comment">//generate random UUIDs
</span>    UUID idOne = UUID.randomUUID();
    UUID idTwo = UUID.randomUUID();
    log(<span class="literal">"UUID One: "</span> + idOne);
    log(<span class="literal">"UUID Two: "</span> + idTwo);
  }
  
  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> log(Object object){
    System.out.println( String.valueOf(object) );
  }
} 
</pre>

<br>Example run:
<p></p><pre>
&gt;java -cp . GenerateUUID
UUID One: 067e6162-3b6f-4ae2-a171-2470b63dff00 
UUID Two: 54947df8-0e9e-4471-a2f9-9af509fb5889
</pre>

<p><b>If Java 5 is not available</b>, then there are other more laborious ways to 
generate unique ids (see below).

</p><h3>Style 2 - SecureRandom and MessageDigest</h3>
<p>The following method uses <code>SecureRandom</code> and <code>MessageDigest</code>:
</p><ul>
<li>
upon startup, initialize <code><a href="https://docs.oracle.com/javase/10/docs/api/java/security/SecureRandom.html">SecureRandom</a></code>
(this may be a lengthy operation)</li>

<li>
when a new identifier is needed, generate a random number using <code>SecureRandom</code></li>

<li>
create a <code><a href="https://docs.oracle.com/javase/10/docs/api/java/security/MessageDigest.html">MessageDigest</a></code>
of the random number</li>

<li>
encode the <code>byte[]</code> returned by the <code>MessageDigest</code> into
some acceptable textual form</li>

<li>
check if the result is already being used; if it's not already taken,
it's suitable as a unique identifier</li>
</ul>
The <code>MessageDigest</code> class is suitable for generating a "one-way
hash" of&nbsp; arbitrary data. (Note that hash values never uniquely identify
their source data, since different source data can produce the same hash
value. The value of <code>hashCode</code>, for example, does not uniquely identify
its associated object.) A <code>MessageDigest</code> takes any input, and produces
a <code>String</code> which:
<ul>
<li>
is of fixed length</li>

<li>
does not allow the original input to be easily recovered (in fact, this
is very hard)</li>

<li>
does not uniquely identify the input; however, similar input will produce
dissimilar message digests</li>
</ul>
<code>MessageDigest</code> is often used as a checksum, for verifying that
data has not been altered since its creation.

<p><b>Example</b>
<br></p><pre>
<span class="keyword">import</span> java.security.SecureRandom;
<span class="keyword">import</span> java.security.MessageDigest;
<span class="keyword">import</span> java.security.NoSuchAlgorithmException;

<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> GenerateId {

  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main (String... arguments) {
    <span class="keyword">try</span> {
      <span class="comment">//Initialize SecureRandom
</span>      <span class="comment">//This is a lengthy operation, to be done only upon
</span>      <span class="comment">//initialization of the application
</span>      SecureRandom prng = SecureRandom.getInstance(<span class="literal">"SHA1PRNG"</span>);

      <span class="comment">//generate a random number
</span>      String randomNum = Integer.valueOf(prng.nextInt()).toString();

      <span class="comment">//get its digest
</span>      MessageDigest sha = MessageDigest.getInstance(<span class="literal">"SHA-1"</span>);
      <span class="keyword">byte</span>[] result =  sha.digest(randomNum.getBytes());

      System.out.println(<span class="literal">"Random number: "</span> + randomNum);
      System.out.println(<span class="literal">"Message digest: "</span> + hexEncode(result));
    }
    <span class="keyword">catch</span> (NoSuchAlgorithmException ex) {
      System.err.println(ex);
    }
  }

  <span class="comment">/**
  * The byte[] returned by MessageDigest does not have a nice
  * textual representation, so some form of encoding is usually performed.
  *
  * This implementation follows the example of David Flanagan's book
  * "Java In A Nutshell", and converts a byte array into a String
  * of hex characters.
  *
  * Another popular alternative is to use a "Base64" encoding.
  */</span>
  <span class="keyword">static</span> <span class="keyword">private</span> String hexEncode(<span class="keyword">byte</span>[] input){
    StringBuilder result = <span class="keyword">new</span> StringBuilder();
    <span class="keyword">char</span>[] digits = {<span class="literal">'0'</span>, <span class="literal">'1'</span>, <span class="literal">'2'</span>, <span class="literal">'3'</span>, <span class="literal">'4'</span>,<span class="literal">'5'</span>,<span class="literal">'6'</span>,<span class="literal">'7'</span>,<span class="literal">'8'</span>,<span class="literal">'9'</span>,<span class="literal">'a'</span>,<span class="literal">'b'</span>,<span class="literal">'c'</span>,<span class="literal">'d'</span>,<span class="literal">'e'</span>,<span class="literal">'f'</span>};
    <span class="keyword">for</span> (<span class="keyword">int</span> idx = <span class="literal">0</span>; idx &lt; input.length; ++idx) {
      <span class="keyword">byte</span> b = input[idx];
      result.append(digits[ (b&amp;<span class="literal">0xf0</span>) &gt;&gt; <span class="literal">4</span> ]);
      result.append(digits[ b&amp;<span class="literal">0x0f</span>]);
    }
    <span class="keyword">return</span> result.toString();
  }
} 
</pre>

<br>Example run:

<p></p><p><code>&gt;java -cp . GenerateId</code>
<br><code>Random number: -1103747470</code>
<br><code>Message digest: c8fff94ba996411079d7114e698b53bac8f7b037</code>

</p><h3>Style 3 - UID</h3>
Finally, here is another method, using a <code><a href="https://docs.oracle.com/javase/10/docs/api/java/rmi/server/UID.html">java.rmi.server.UID</a></code>.
The <code>Serializable</code> identifiers generated by this class are unique
on the host on which they are generated, provided that
<ul>
<li>the host takes more than one millisecond to reboot</li>
<li>the host's clock is never set to run backwards</li>
</ul>
In order to construct a <code>UID</code> that is globally unique, simply pair
a <code>UID</code> with an <code><a href="https://docs.oracle.com/javase/10/docs/api/java/net/InetAddress.html">InetAddress</a></code>.

<p><b>Example</b>
<br></p><pre>
<span class="keyword">import</span> java.rmi.server.UID;

<span class="keyword">public</span> <span class="keyword">class</span> UniqueId {

  <span class="comment">/**
  * Build and display some UID objects.
  */</span>
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main (String... arguments) {
    <span class="keyword">for</span> (<span class="keyword">int</span> idx=<span class="literal">0</span>; idx&lt;<span class="literal">10</span>; ++idx){
      UID userId = <span class="keyword">new</span> UID();
      System.out.println(<span class="literal">"User Id: "</span> + userId);
    }
  }
} 
</pre>

<p></p><p>Example run:
</p><p><code>User Id: 3179c3:ec6e28a7ef:-8000</code>
<br><code>User Id: 3179c3:ec6e28a7ef:-7fff</code>
<br><code>User Id: 3179c3:ec6e28a7ef:-7ffe</code>
<br><code>User Id: 3179c3:ec6e28a7ef:-7ffd</code>
<br><code>User Id: 3179c3:ec6e28a7ef:-7ffc</code>
<br><code>User Id: 3179c3:ec6e28a7ef:-7ffb</code>
<br><code>User Id: 3179c3:ec6e28a7ef:-7ffa</code>
<br><code>User Id: 3179c3:ec6e28a7ef:-7ff9</code>
<br><code>User Id: 3179c3:ec6e28a7ef:-7ff8</code>
<br><code>User Id: 3179c3:ec6e28a7ef:-7ff7</code>

</p><p>Clearly, these are not secure identifiers - knowing one, it's easy
to guess another.
<br>
</p>
<p></p>


<footer id="footer" class="legalese">
<span id="app_name">Java Practices</span> <span id="app_version_number">3.011</span><br>
© <span id="copyright">2018 Hirondelle Systems</span><br>
<a href="../source/SourceAction.html">Source Code</a> |
<a href="mailto:webmaster@javapractices.com" rel="author">Contact</a> |
<a href="https://creativecommons.org/licenses/by-nc-sa/1.0/" rel="license">License</a> |
<a href="../apps/cjp.rss" rel="alternate" type="application/rss+xml">RSS</a>
<!-- ukey="2AC36CD2" -->
<!-- ckey="16DF3D87" -->
<br>
 Individual code snippets have a <a href="../LICENSE.txt" rel="license">BSD license</a><br>
 Over 1,000,000 unique IPs last year<br>
 Last updated <time id="last_updated_on" datetime="2018-09-15">2018-09-15</time><br> 
 - In Memoriam : Bill Dirani -
</footer>
</body>
<!-- Mirrored from www.javapractices.com/topic/TopicAction.do?Id=56 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Jan 2021 15:52:36 GMT -->
</html>
